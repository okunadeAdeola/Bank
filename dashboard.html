<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="bootstrap.css">
    <link rel="stylesheet" href="dashboard.css">
</head>

<body>
    <div class="col-lg-11 col-md-8 col-sm-12">
      <img id="bell" src="./image/bell.png" height="30px" alt="">
      <ul id="menu" class="nav nav-pills">
        <li class="nav-item dropdown">
          <a class="nav-link dropdown-toggle text-light" data-bs-toggle="dropdown" href="#" role="button" aria-expanded="false">MENU</a>
          <ul class="dropdown-menu">
            <li class="w-100 bg-light  text-center"><a class="dropdown-item" href="#"><span ><img src="image/acc.png" height="20px" alt=""></span><span id="userInfo" class="text-primary "></span></a></li>
            <li><a class="dropdown-item" href="#"><span><img src="./image/ico1.png" height="20px" alt=""></span> Send Money</a></li>
            <li><hr class="dropdown-divider"></li>
            <li><a class="dropdown-item" href="#"><span><img src="./image/airttime ico.png" height="20px" alt=""></span> Airtime & Data</a></li>
            <li><hr class="dropdown-divider"></li>
            <li><a class="dropdown-item" href="#"><span><img src="./image/bills.png" height="20px" alt=""></span> Bills Payment</a></li>
            <li><hr class="dropdown-divider"></li>
            <li><a class="dropdown-item" href="#"><span><img src="./image/lifestyle.jpg" height="20px" alt=""></span> Lifestyle</a></li>
            <li><hr class="dropdown-divider"></li>
            <li><a class="dropdown-item" href="#"><span><img src="./image/invset.png" height="20px" alt=""></span> Invest & Loan</a></li>
            <li><hr class="dropdown-divider"></li>
            <li><a class="dropdown-item" href="#"><span><img src="./image/cash pick up.jpg" height="20px" alt=""></span> Cash Pick-Up</a></li>
            <li><hr class="dropdown-divider"></li>
            <li><a class="dropdown-item" href="#"><span><img src="./image/cards3.png" height="20px" alt=""></span> Cards</a></li>
            <li><hr class="dropdown-divider"></li>
            <li><a class="dropdown-item" href="signUp.html"><span><img src="./image/acc.png" height="20px" alt=""></span> Account</a></li>
            <li><hr class="dropdown-divider"></li>
            <li><a class="dropdown-item" href="#"><span><img src="image/bell.png" height="20px" alt=""></span> Settings & Support</a></li>
            <li><hr class="dropdown-divider"></li>
            <li><a class="dropdown-item" href="#"><span><img src="./image/cheque.jpg" height="20px" alt=""></span> Cheques</a></li>
            <a href="index.html"><button onclick="logout()" class="btn btn-danger w-100 mt-2"><span><img src="./image/logout.jpg" height="30px" alt=""></span> Logout</button></a>
            
          </ul>
        </li>
      </ul>
     <!-- Modal -->
      <div id="card" class="card shadow rounded">
        <h5 class="card-header">Total Balance:<input type="text" id="userAmount"disabled>
          <span>#</span>
        
       
        <div class="card-body d-flex">
            <div><button id="three" class="btn"  onclick="deposit()">Deposit⬇</button></div>
            <button id="four" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#exampleModal" onclick="transfer()">Transfer</button>
            <div><button id="five" class="btn" onclick="buyAirtime()">Buy Airtime <span><img src="./image/airttime ico.png" height="20px" alt=""></span></button></div> 
          <button id="six" type="button" onclick="withdraw()" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#exampleModal">Withdraw</button>
        </div>
      </div>
    </div>
  </div>
   
    <!-- <div id="disp"></div> -->
    <div class="row">
        <div id="cardone" class="col-sm-6 mt-5 mb-sm-0">
          <div class="card shadow rounded">
            <div class="card-body">
              <h5 class="card-title">Naira</h5>
              <p class="card-text">#0</p>
              <a href="#" class="btn btn-primary">Trade in Naira</a>
            </div>
          </div>
        </div>
        <div class="col-sm-6 mt-5">
          <div id="cardtwo" class="card shadow rounded">
            <div class="card-body">
              <h5 class="card-title">Dollar</h5>
              <p class="card-text">$0</p> 
              <a href="#" class="btn btn-primary">Trade in Dollar</a>
            </div>
          </div>
        </div>
      </div>

      <div class="row">
        <div id="cardthree" class="col-sm-6 mt-5 mb-sm-0">
          <div class="card shadow rounded">
            <div class="card-body">
              <h5 class="card-title">Pounds</h5>
              <p class="card-text"><img  src="./image/pou.png" height="12px" alt="">o</p>
              <a href="#" class="btn btn-primary">Trade in Pounds</a>
            </div>
          </div>
        </div>
        <div id="cardfour" class="col-sm-6 mt-5">
          <div class="card shadow rounded">
            <div class="card-body">
              <h5 class="card-title">Euro</h5>
              <p class="card-text">€0</p> 
              <a href="#" class="btn btn-primary">Trade in Euro</a>
            </div>
          </div>
        </div>
      </div>

      
      <div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
        <div class="modal-dialog">
          <div class="modal-content">
            <div class="modal-header">
              <h1 class="modal-title fs-5" id="exampleModalLabel">Modal title</h1>
              <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
             <input type="text" placeholder="Amount" id="amounttranfer">
             <input type="text" placeholder="Beneficiary Account Number" id="benA">
             <input type="text" placeholder="Beneficiary Name" id="benN">
             <input type="text" placeholder="Pin" id="pin">
            </div>
            <div class="modal-footer">
              <button type="button" onclick="transfer()" class="btn btn-primary"data-bs-dismiss="modal">UPDATE</button>
            </div>
          </div>
        </div>
      </div>

    <script>
      if(!localStorage.userIndex){
        window.location.href = 'signIn.html'
      }
        var  allUsers = JSON.parse(localStorage.getItem("score")) ;
    var storage = localStorage.getItem("userIndex")
    userAmount.value = allUsers[storage].amount
    document.getElementById('userInfo').innerHTML = `Welcome ${allUsers [storage].email} </br> Your Account Number is ${allUsers [storage].accountNumber}`
    var Amount=allUsers[storage].amount
     var tpin=allUsers[storage].pin

    const transfer=()=>{
         if(Amount < amounttranfer.value){
          alert("insufficient balance")
         } 
        //  else if(transfer){
        //    allUsers[storage].balance = Number(allUsers[storage].Amount) - Number(amounttranfer.value)
        //  }
          else if(tpin == pin.value){   
           allUsers[storage].amount=Number(allUsers[storage].amount) + Number(amounttranfer.value)
          userAmount.value = allUsers[storage].amount
          window.location.href = "congrats.html"
          localStorage.setItem("score", JSON.stringify(allUsers));
          allUsers[storage].amount -= amountTransfer;
    }
      for (let index = 0; index < allUsers.length; index++) {
         if(benA.value==allUsers[index].accountNumber){
          allUsers[index].amount=Number(allUsers[index].amount) + Number(amounttranfer.value)
          localStorage.setItem("score", JSON.stringify(allUsers));
         }
      }    
      }

//     const transfer = () => {
//     console.log("Transfer function called"); // Add this line

//     const amountTransfer = Number(amounttranfer.value);
//     const pinValue = pin.value;
//     const senderIndex = parseInt(storage);

//     const receiverAccount = allUsers.find(user => user.accountNumber === benA.value);
//     if (receiverAccount) {
//         receiverAccount.amount += amountTransfer;
//         allUsers[senderIndex].amount -= amountTransfer;
//         userAmount.value = allUsers[senderIndex].amount;

//         console.log("Sender's balance updated:", allUsers[senderIndex].amount);
//         localStorage.setItem("score", JSON.stringify(allUsers));
//         window.location.href = "congrats.html";
//     } else {
//         alert("Receiver account not found.");
//         return;
//     }
// };

 
      const deposit =()=>{
        window.location.href = "deposit.html"
          // var y =  prompt("how much  did you want to deposit?")
          // allUsers[storage].amount  =  (Number(allUsers[storage].amount) +  Number(y))
          //  userAmount.value = allUsers[storage].amount
          //  localStorage.setItem("score", JSON.stringify(allUsers));
        }
        const buyAirtime =()=>{
          window.location.href = "airtime.html"
          // var allUsers =  prompt("How much did you want to buy?")
          // console.log(answer);
          // // disp.innerHTML = answer
          // bal.value = answer 
        }
        const logout =()=>{
          localStorage.removeItem('userIndex')
          window.location.href = "signIn.html"
        }
    // if (!localStorage.userIndex) {
    //         window.location.href = 'signIn.html';
    //     }
        
    //     var allUsers = JSON.parse(localStorage.getItem("score"));
    //     var storage = localStorage.getItem("userIndex");
    //     userAmount.value = allUsers[storage].amount;
    //     document.getElementById('userInfo').innerHTML = `Welcome ${allUsers[storage].email} </br> Your Account Number is ${allUsers[storage].accountNumber}`;
    //     var Amount = allUsers[storage].amount;
    //     var tpin = allUsers[storage].pin;

    //     const transfer = () => {
    //         const amountTransfer = Number(amounttranfer.value);
    //         const pinValue = pin.value;
    //         const senderIndex = parseInt(storage);

    //         if (isNaN(amountTransfer) || amountTransfer <= 0) {
    //             alert("Please enter a valid transfer amount.");
    //             return;
    //         }

    //         if (Amount < amountTransfer) {
    //             alert("Insufficient balance.");
    //             return;
    //         }

    //         if (tpin !== pinValue) {
    //             alert("Incorrect T-PIN.");
    //             return;
    //         }

    //         // Deduct amount from sender's balance
    //         allUsers[senderIndex].amount -= amountTransfer;

    //         // Find receiver's account and add amount
    //         const receiverAccount = allUsers.find(user => user.accountNumber === benA.value);
    //         if (receiverAccount) {
    //             receiverAccount.amount += amountTransfer;
    //         } else {
    //             alert("Receiver account not found.");
    //             return;
    //         }

    //         // Update local storage
    //         localStorage.setItem("score", JSON.stringify(allUsers));

    //         // Redirect to congrats.html or any other page
    //         window.location.href = "congrats.html";
    //     };

    //     const deposit = () => {
    //         window.location.href = "deposit.html";
    //     };

    //     const buyAirtime = () => {
    //         window.location.href = "airtime.html";
    //     };

    //     const logout = () => {
    //         localStorage.removeItem('userIndex');
    //         window.location.href = "signIn.html";
    //     };
    </script>
</body>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ENjdO4Dr2bkBIFxQpeoTz1HIcje39Wm4jDKdf19U8gI4ddQ3GYNS7NTKfAdVQSZe" crossorigin="anonymous"></script>
</html>